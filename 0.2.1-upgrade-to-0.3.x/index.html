<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">

	<title>Upgrading from 0.2.1 - SecureDrop</title>

        <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link rel="stylesheet" href="../css/highlight.css">
        <link href="../css/base.css" rel="stylesheet">
        <link href="../css/extra.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="..">SecureDrop</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li >
                    <a href="..">Home</a>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Installation <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../installation/install/">Installation Overview</a>
                        </li>
                    
                        <li >
                            <a href="../installation/hardware/">Hardware Requirements</a>
                        </li>
                    
                        <li >
                            <a href="../installation/deployment_practices/">Deployment Practices</a>
                        </li>
                    
                        <li >
                            <a href="../installation/ubuntu_config/">Server Config</a>
                        </li>
                    
                        <li >
                            <a href="../installation/network_firewall/">Network Firewall</a>
                        </li>
                    
                        <li >
                            <a href="../installation/ossec_alerts/">OSSEC Alerts</a>
                        </li>
                    
                        <li >
                            <a href="../installation/yubikey_setup/">Yubikey Setup</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Support <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../source_user_manual/">Source User Manual</a>
                        </li>
                    
                        <li >
                            <a href="../journalist_user_manual/">Journalist User Manual</a>
                        </li>
                    
                        <li >
                            <a href="../admin_interface/">Admin User Manual</a>
                        </li>
                    
                        <li >
                            <a href="../tails_guide/">Using Tails</a>
                        </li>
                    
                        <li >
                            <a href="../google_authenticator/">Google Authenticator</a>
                        </li>
                    
                        <li class="active">
                            <a href="">Upgrading SecureDrop</a>
                        </li>
                    
                        <li >
                            <a href="../tails_printing_guide/">Printing with Tails</a>
                        </li>
                    
                        <li >
                            <a href="../terminology/">Terminology</a>
                        </li>
                    
                        <li >
                            <a href="../threat_model/">Threat Model</a>
                        </li>
                    
                        <li >
                            <a href="../training_schedule/">Training Schedule</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contributing <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../develop/">Development Environment</a>
                        </li>
                    
                        <li >
                            <a href="">Running the Tests</a>
                        </li>
                    
                        <li >
                            <a href="../apparmor_profiles/">AppArmor Profiles</a>
                        </li>
                    
                        <li >
                            <a href="../creating_deb/">Building .deb packages</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                <li >
                    <a rel="next" href="../google_authenticator/">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../0.3-pre-upgrade-to-0.3.x/">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#upgrading-021-version">Upgrading 0.2.1 version</a></li>
        
            <li><a href="#prerequisites">Prerequisites</a></li>
        
            <li><a href="#upgrade-021-steps">Upgrade 0.2.1 steps</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h1 id="upgrading-021-version">Upgrading 0.2.1 version</h1>
<h2 id="prerequisites">Prerequisites</h2>
<ul>
<li>
<p>A networked Admin tails workstation configured with the SecureDrop repo cloned to the <code>Persistent</code> directory.</p>
</li>
<li>
<p>Physical/remote access to the app and monitor servers</p>
</li>
</ul>
<h2 id="upgrade-021-steps">Upgrade 0.2.1 steps</h2>
<ul>
<li>Verify the current release number.</li>
<li>The upgrade steps in this document will work for each <code>0.3.x</code> SecureDrop version.</li>
<li>
<p>Throughout the rest of this document substitute <code>0.3.x</code> with the current version's minor release number.</p>
</li>
<li>
<p>Checkout and verify the current release on the Admin Workstation.
  <code>sh
  cd /home/amnesia/Persistent/SecureDrop
  git pull
  git checkout 0.3.x
  git tag -v 0.3.x</code></p>
</li>
<li>
<p>Copy the 0.2.1 migration script to the app server using scp or physical media (usb).</p>
</li>
</ul>
<p><code>/home/amnesia/Persistent/securedrop/migration_scripts/0.2.1/0.2.1_collect.py</code></p>
<ul>
<li>On the app server, run <code>0.2.1_collect.py</code> as root and provide a name for the backup.</li>
</ul>
<p><code>sudo ./0.2.1_collect.py sdbackup</code></p>
<ul>
<li>
<p>Copy <code>sdbackup.tar.gz</code> to removable media and transfer it to the  new instance's app server. If you are re-using the same hardware for  your 0.3.x installation as you did for 0.2.1, make sure you copy this file to a external media before beginning the 0.3.x installation - otherwise you will lose your data!</p>
</li>
<li>
<p>Checkout the current release, or if browsing the <a href="https://github.com/freedomofpress/securedrop">FPF github.com repo</a> webpage, change the <code>branch</code> to <code>tags/0.3.x</code></p>
</li>
<li>
<p>Browsing the website only relies on the security of the CA and SSL to prevent MITM attacks. Cloning the repo and verifying the tags' signature checks that the code has not been modified since FPF gpg signed it.</p>
</li>
<li>
<p>Follow the install guide in <code>docs/install.md</code></p>
</li>
<li>
<p>Make sure you've created at least one user on the Document Interface (with <code>./manage.py add_admin</code>) before continuing.</p>
</li>
<li>
<p>Once you've successfully installed 0.3.x, copy <code>sdbackup.tar.gz</code> to any location on the 0.3.x app server. You will need <code>0.3_migrate.py</code>, along with the rest of the files in <code>migration_scripts/0.2.1</code>. You can copy the <code>0.2.1</code> directory to the running instance with a flash drive, or <code>git clone</code> the repo on the new app server and <code>cd</code> into <code>securedrop/migration_scripts/0.2.1</code>.</p>
</li>
<li>
<p>Once that's done, run <code>0.3_migrate.py</code> as root, passing the path to the backup from the 0.2.1 machine.</p>
</li>
</ul>
<p><code>sudo ./0.3_migrate.py sdbackup.tar.gz</code></p>
<p>The script will say "Done!" when it completes successfully.  Otherwise, it will print an error and a Python traceback. If you  encounter such an error, please encrypt the traceback and email it to us at securedrop@freedom.press.</p>
<p>Finally, test your new installation and make sure that everything was successfully migrated.</p></div>
        </div>

        <footer class="col-md-12">
            <hr>
            
            <center>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</center>
        </footer>

        <script src="../js/jquery-1.10.2.min.js"></script>
        <script src="../js/bootstrap-3.0.3.min.js"></script>
        <script src="../js/highlight.pack.js"></script>
        <script src="../js/base.js"></script>
    </body>
</html>