<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">

	<title>Yubikey Setup - SecureDrop</title>

        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../css/base.css" rel="stylesheet">
        <link href="../../css/extra.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="../..">SecureDrop</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li >
                    <a href="../..">Home</a>
                </li>
            
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Installation <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../install/">Installation Overview</a>
                        </li>
                    
                        <li >
                            <a href="../hardware/">Hardware Requirements</a>
                        </li>
                    
                        <li >
                            <a href="../deployment_practices/">Deployment Practices</a>
                        </li>
                    
                        <li >
                            <a href="../ubuntu_config/">Server Config</a>
                        </li>
                    
                        <li >
                            <a href="../network_firewall/">Network Firewall</a>
                        </li>
                    
                        <li >
                            <a href="../ossec_alerts/">OSSEC Alerts</a>
                        </li>
                    
                        <li class="active">
                            <a href="./">Yubikey Setup</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Support <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../source_user_manual/">Source User Manual</a>
                        </li>
                    
                        <li >
                            <a href="../../journalist_user_manual/">Journalist User Manual</a>
                        </li>
                    
                        <li >
                            <a href="../../admin_interface/">Admin User Manual</a>
                        </li>
                    
                        <li >
                            <a href="../../tails_guide/">Using Tails</a>
                        </li>
                    
                        <li >
                            <a href="../../google_authenticator/">Google Authenticator</a>
                        </li>
                    
                        <li >
                            <a href="">Upgrading SecureDrop</a>
                        </li>
                    
                        <li >
                            <a href="../../tails_printing_guide/">Printing with Tails</a>
                        </li>
                    
                        <li >
                            <a href="../../terminology/">Terminology</a>
                        </li>
                    
                        <li >
                            <a href="../../threat_model/">Threat Model</a>
                        </li>
                    
                        <li >
                            <a href="../../training_schedule/">Training Schedule</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contributing <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../develop/">Development Environment</a>
                        </li>
                    
                        <li >
                            <a href="">Running the Tests</a>
                        </li>
                    
                        <li >
                            <a href="../../apparmor_profiles/">AppArmor Profiles</a>
                        </li>
                    
                        <li >
                            <a href="../../creating_deb/">Building .deb packages</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                <li >
                    <a rel="next" href="../ossec_alerts/">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../../source_user_manual/">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#using-yubikey-with-the-document-interface">Using YubiKey with the Document Interface</a></li>
        
            <li><a href="#download-the-yubikey-personalization-tool">Download the YubiKey personalization tool</a></li>
        
            <li><a href="#set-up-oath-hotp">Set up OATH-HOTP</a></li>
        
            <li><a href="#set-up-a-user-with-the-oath-hotp-secret-key">Set up a user with the OATH-HOTP secret key</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h1 id="using-yubikey-with-the-document-interface">Using YubiKey with the Document Interface</h1>
<p>This is a quick and dirty guide to using YubiKey for two-factor authentication on the Document Interface.</p>
<h2 id="download-the-yubikey-personalization-tool">Download the YubiKey personalization tool</h2>
<p>YubiKeys are modifiable using the YubiKey personalization tool, which is available for Windows/Mac/Linux and can be downloaded here: https://www.yubico.com/products/services-software/personalization-tools/use/. If you wish to use Tails, install the YubiKey personalization tool on the command line with <code>apt-get install yubikey-personalization-gui</code>.</p>
<p>Once you have downloaded and installed the personalization program, insert your YubiKey and launch the program. If you are running Tails, you need to launch the program as the root user.</p>
<h2 id="set-up-oath-hotp">Set up OATH-HOTP</h2>
<p>When you first launch the program, you will see the heading "Personalize your YubiKey in:" following by a list of configuration options. The SecureDrop admin interface uses "OATH-HOTP mode", so click that entry in the list.</p>
<p>The next window will have the heading "Program in OATH-HOTP mode" and will offer you a choice between "Quick" or "Advanced" configuration. Choose "Quick".</p>
<p>First choose the configuration slot for this token. Unless you already use the YubiKey for something else, you should choose Configuration Slot 1. If you already using the first slot, choose Configuration Slot 2. Note that you will have to press and hold for several seconds to use the token from Slot 2 instead of the one in Slot 1. See the <a href="https://www.yubico.com/wp-content/uploads/2013/07/YubiKey-Manual-v3_1.pdf">YubiKey manual</a> for more information.</p>
<p>In the section title "OATH-HOTP parameters", you will need to change the default settings. First, <em>uncheck</em> the checkbox for "OATH Token Identifier (6 bytes)". Also uncheck the box for "Hide secret". This will display the data in the "Secret Key (20 bytes hex)" field. This data cannot be copied unless the "Hide secret" box is unchecked.</p>
<p><img alt="YubiKey OATH-HOTP Configuration" src="../images/yubikey_oath_hotp_configuration.png" /></p>
<p>Now that you have chosen the correct configuration options for use with SecureDrop, click the "Write Configuration" button. Click through the warning about overwriting Configuration Slot 1 and choose a location to save the log file.</p>
<p>When the configuration has been successfully written, you should see green text saying "YubiKey successfully configured" at the top of the window.</p>
<h2 id="set-up-a-user-with-the-oath-hotp-secret-key">Set up a user with the OATH-HOTP secret key</h2>
<p>Now you will have to set up a new user for the Document Interface with the secret key from the "Secret Key (20 bytes hex)" field.</p>
<h3 id="managepy">manage.py</h3>
<p>If you have just installed SecureDrop, you will need to add the first admin user to the Document Interface with <code>manage.py</code>. <code>cd</code> to the <code>SECUREDROP_ROOT</code>, which is <code>/vagrant/securedrop</code> in development and <code>/var/www/securedrop</code> in production. Run <code>./manage.py add_admin</code>. Fill in the username and password prompts. When it asks "Is this admin using a YubiKey [HOTP]? (y/N)", type "y", then enter. At the "Please configure your YubiKey and enter the secret:" prompt, enter the Secret Key value and hit enter. Note that the spaces are optional. When you are done, you should see a message saying "Admin '(your username)' successfully added".</p>
<h3 id="admin-interface">Admin Interface</h3>
<p>If you already have an admin user configured, use the "Add user" page in the admin interface to add new users. If they want to use YubiKey for two-factor, just check the "I'm using a YubiKey [HOTP]" checkbox and enter the Secret Key in the "HOTP secret" field.</p></div>
        </div>

        <footer class="col-md-12">
            <hr>
            
            <center>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</center>
        </footer>

        <script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
        <script src="../../js/base.js"></script>
    </body>
</html>