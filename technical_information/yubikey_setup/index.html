<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Yubikey Setup - SecureDrop</title>
  

  <link rel="shortcut icon" href="../../img/favicon.ico">

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">
  <link href="../../site/css/base.css" rel="stylesheet">
  <link href="../../site/css/bootstrap-custom.min.css" rel="stylesheet">
  <link href="../../site/css/extra.css" rel="stylesheet">
  <link href="../../site/css/font-awesome-4.0.3.css" rel="stylesheet">
  <link href="../../site/css/highlight.css" rel="stylesheet">
  <link href="../../css/extra.css" rel="stylesheet">

  
  <script>
    // Current page data
    var mkdocs_page_name = "Yubikey Setup";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script>
  <script src="../../js/theme.js"></script> 
  <script src="../../site/js/base.js"></script>
  <script src="../../site/js/bootstrap-3.0.3.min.js"></script>
  <script src="../../site/js/highlight.pack.js"></script>
  <script src="../../site/js/jquery-1.10.2.min.js"></script>
  <script src="../../site/mkdocs/js/lunr-0.5.7.min.js"></script>
  <script src="../../site/mkdocs/js/mustache.min.js"></script>
  <script src="../../site/mkdocs/js/require.js"></script>
  <script src="../../site/mkdocs/js/search.js"></script>
  <script src="../../site/mkdocs/js/text.js"></script>

  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> SecureDrop</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../..">Home</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Installation</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../installation/intro/">Getting started</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../installation/setup_tails_usb_sticks/">Set up Tails USB Sticks</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../installation/setup_svs/">Set up Secure Viewing Station</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../installation/setup_admin_workstation/">Set up Admin Workstation</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../installation/network_firewall/">Network Firewall</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../installation/ubuntu_config/">Server Config</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../installation/securedrop_app/">Install SecureDrop Application</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../installation/final_steps/">Finalizing the Installation</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Support</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../support/source_user_manual/">Source User Manual</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../support/journalist_user_manual/">Journalist User Manual</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../support/admin_interface/">Admin User Manual</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../support/tails_guide/">Using Tails</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../support/upgrade/">Upgrading SecureDrop</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../support/tails_printing_guide/">Printing with Tails</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../support/terminology/">Terminology</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../support/training_schedule/">Training Schedule</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Technical Information</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../hardware/">Hardware Requirements</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../deployment_practices/">Deployment Practices</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../ossec_alerts/">OSSEC Alerts</a>
        
    </li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">Yubikey Setup</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#using-yubikey-with-the-document-interface">Using YubiKey with the Document Interface</a></li>
                
                    <li><a class="toctree-l4" href="#download-the-yubikey-personalization-tool">Download the YubiKey personalization tool</a></li>
                
                    <li><a class="toctree-l4" href="#set-up-oath-hotp">Set up OATH-HOTP</a></li>
                
                    <li><a class="toctree-l4" href="#set-up-a-user-with-the-oath-hotp-secret-key">Set up a user with the OATH-HOTP secret key</a></li>
                
            
            </ul>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../threat_model/">Threat Model</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../google_authenticator/">Google Authenticator</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Contributing</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../contributing/develop/">Development Environment</a>
        
    </li>

        
            
    <ul class="subnav">
    <li><span>Running the Tests</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../contributing/spec_tests/">Serverspec Tests</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../contributing/snap_ci/">Automated CI Tests</a>
        
    </li>

        
    </ul>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../contributing/apparmor_profiles/">AppArmor Profiles</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../contributing/creating_deb/">Building .deb packages</a>
        
    </li>

        
    </ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">SecureDrop</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Technical Information &raquo;</li>
        
      
    
    <li>Yubikey Setup</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="using-yubikey-with-the-document-interface">Using YubiKey with the Document Interface</h1>
<p>This is a quick and dirty guide to using YubiKey for two-factor authentication on the Document Interface.</p>
<h2 id="download-the-yubikey-personalization-tool">Download the YubiKey personalization tool</h2>
<p>YubiKeys are modifiable using the YubiKey personalization tool, which is available for Windows/Mac/Linux and can be downloaded here: https://www.yubico.com/products/services-software/personalization-tools/use/. If you wish to use Tails, install the YubiKey personalization tool on the command line with <code>apt-get install yubikey-personalization-gui</code>.</p>
<p>Once you have downloaded and installed the personalization program, insert your YubiKey and launch the program. If you are running Tails, you need to launch the program as the root user.</p>
<h2 id="set-up-oath-hotp">Set up OATH-HOTP</h2>
<p>When you first launch the program, you will see the heading "Personalize your YubiKey in:" following by a list of configuration options. The SecureDrop admin interface uses "OATH-HOTP mode", so click that entry in the list.</p>
<p>The next window will have the heading "Program in OATH-HOTP mode" and will offer you a choice between "Quick" or "Advanced" configuration. Choose "Quick".</p>
<p>First choose the configuration slot for this token. Unless you already use the YubiKey for something else, you should choose Configuration Slot 1. If you already using the first slot, choose Configuration Slot 2. Note that you will have to press and hold for several seconds to use the token from Slot 2 instead of the one in Slot 1. See the <a href="https://www.yubico.com/wp-content/uploads/2013/07/YubiKey-Manual-v3_1.pdf">YubiKey manual</a> for more information.</p>
<p>In the section title "OATH-HOTP parameters", you will need to change the default settings. First, <em>uncheck</em> the checkbox for "OATH Token Identifier (6 bytes)". Also uncheck the box for "Hide secret". This will display the data in the "Secret Key (20 bytes hex)" field. This data cannot be copied unless the "Hide secret" box is unchecked.</p>
<p><img alt="YubiKey OATH-HOTP Configuration" src="../../images/yubikey_oath_hotp_configuration.png" /></p>
<p>Now that you have chosen the correct configuration options for use with SecureDrop, click the "Write Configuration" button. Click through the warning about overwriting Configuration Slot 1 and choose a location to save the log file.</p>
<p>When the configuration has been successfully written, you should see green text saying "YubiKey successfully configured" at the top of the window.</p>
<h2 id="set-up-a-user-with-the-oath-hotp-secret-key">Set up a user with the OATH-HOTP secret key</h2>
<p>Now you will have to set up a new user for the Document Interface with the secret key from the "Secret Key (20 bytes hex)" field.</p>
<h3 id="managepy">manage.py</h3>
<p>If you have just installed SecureDrop, you will need to add the first admin user to the Document Interface with <code>manage.py</code>. <code>cd</code> to the <code>SECUREDROP_ROOT</code>, which is <code>/vagrant/securedrop</code> in development and <code>/var/www/securedrop</code> in production. Run <code>./manage.py add_admin</code>. Fill in the username and password prompts. When it asks "Is this admin using a YubiKey [HOTP]? (y/N)", type "y", then enter. At the "Please configure your YubiKey and enter the secret:" prompt, enter the Secret Key value and hit enter. Note that the spaces are optional. When you are done, you should see a message saying "Admin '(your username)' successfully added".</p>
<h3 id="admin-interface">Admin Interface</h3>
<p>If you already have an admin user configured, use the "Add user" page in the admin interface to add new users. If they want to use YubiKey for two-factor, just check the "I'm using a YubiKey [HOTP]" checkbox and enter the Secret Key in the "HOTP secret" field.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../threat_model/" class="btn btn-neutral float-right" title="Threat Model"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../ossec_alerts/" class="btn btn-neutral" title="OSSEC Alerts"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../ossec_alerts/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../threat_model/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

</body>
</html>
